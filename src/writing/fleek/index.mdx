---
title: "Building a Censorship-Resistant Website with Gatsby"
subtitle: "Building and Deploying A Static Gatsby Site to Ethereum and Solana"
datePublished: "2021-09-30"
hero_image: "./censor.jpeg"
hero_image_alt: "Purple and yellow static screen"
status: "draft"
---

I just recently finished designing and building my new personal site using Gatsby and Tailwind.

I built it using MDX and designed with Tailwind. I'll be writing an article soon on the process I went through for that, but one thing I really wanted to do was get it up on the blockchain at my ENS domain name, krgrs.eth.

The Gatsby site is already deployed at [krgrs.dev](https://krgrs.dev) and I wanted to get a censorship-resistant one up and running and decided to go with [Fleek](https://fleek.co/) to get it done.

If you've used anything along the lines of Netlify or Gatsby Cloud, Fleek will feel very familiar. The setup process is pretty straightforward. Once you create an account you'll be taken to a screen to add your new site.

This is where you'll be able to connect your GitHub repo to Fleek to set up automatic deployments, just like Netlify.

![Fleek's UI for connecting your GitHub repo](./fleek-site-screen.png)

From here, you'll then choose the repo you want to deploy and where to host it. In my case I'll be using IPFS.

![Fleek's UI for choosing your deploy location](./fleek-deploy-location.png)

Finally, you'll set up your build settings. In my case, since I'm using Gatsby, Fleek detects the proper build settings automatically. You may need to adjust these depending on what framework you are using for your site build.

![Fleek's UI for choosing your build settings](./fleek-build-settings.png)

We'll hit the deploy button and Fleek will begin building our site, pushing it to IPFS and generating a hash for us, and deploying it to Fleek's CDN.

Once the deployment is finished, Fleek gives us the URL where we can view our newly deployed site. And just like that, in just a few minutes, we have our website built and hosted on IPFS.

But we aren't done yet. As I mentioned earlier, I have an ENS domain name at krgrs.eth, where I would like this site to live. Luckily, Fleek makes that super easy for us as well.

After the site is deployed, we can go over to the Settings, down to Domain Management, and we see a section for ENS domains.

![Fleek's UI for adding an ENS domain](./fleek-ens.png)

Let's hit that Add ENS button and get our domain hooked up.

This will present us a screen where we can input our ENS domain. What Fleek will do is automatically point our IPFS hash to this domain, so that whenever someone visits our ENS domain, they are served our website.

Fleek will go out and check the address corresponsing to that ENS domain and point the IPFS hash to it.

![Fleek's UI for verifying an ENS domain](./fleek-ens-verify.png)

After you add the domain and verify that the address is correct, you'll need to use your wallet, MetaMask in my case, to set the content hash. You only have to do this once, and Fleek will automatically update the IPFS hash every time you deploy.

**Pay attention to the gas fees here.**

The first time I went to point my IPFS hash to my ENS domain, it would have cost me $415 in gas. I waited a day and tried again and gas was only $29. I'm okay with that, since it's a one time fee. We only have to pay the transaction fee once so Fleek can point the IPFS hash to our ENS domain.

From this point forward, Fleek will update the contents of the IPFS hash for us, so we don't have to worry about transaction fees every time we deploy.

After Fleek finishes setting the hash, we can visit krgrs.eth in Brave and it just takes us to the ENS page, hmm. Not what we want.

If we check Fleek, we can see that the IPFS hash is verified and working, so something is going on here with pointing the hash to the ENS domain.

I'm currently chatting with the Fleek team on Discord to figure out what the issue is here.

In the meantime, I want to get this site pointed to a domain on the Solana blockchain as well.

I've recently gotten very interested in developing on Solana, and a company called [Bonfida](https://naming.bonfida.org) started up a domain service on Solana for .sol domains.

![Bonfida's home page](./bonfida.png)

In order to get that, we have to initiate an auction. The cool thing with the .sol domains is that you don't have to renew them like ENS domains. Once you buy it, you own it forever.

So I go to [https://naming.bonfida.org](https://naming.bonfida.org/#/) hit the register button and begin the auction process.

When registering a .sol domain, you have to start a 7 day auction process and win the auction in order to claim the domain.

The minimum bid is $21 in USDC, in order to prevent people from just sitting on as many domains as they want. So I went ahead and put my bid in at that price and waited the 7 day period for the auction to end.

I have some Solana in my Phantom wallet, but I need to put the bid in USDC, so I'll use Phantom to swap tokens and put my bid in at 21.1 USDC.

![Bonfida's UI for domain auction](./sol-domain.png)

Wait until the auction is over and...

I've got my krgrs.sol domain!

Now let's figure out how to get it to point to my Gatsby site.
